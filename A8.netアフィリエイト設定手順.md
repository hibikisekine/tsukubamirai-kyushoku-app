# 🛒 A8.netアフィリエイト設定手順

## 前提条件

- A8.netのアカウントを持っている
- サイトが公開されている（kyushoku.site）

## ステップ1: A8.netでConfig IDを確認（リンクマネージャー用）

A8.netのリンクマネージャーを使用する場合、**Config ID**が必要です。

1. **A8.netにログイン**
   - https://www.a8.net/ にアクセス
   - ログイン

2. **リンクマネージャーの設定を確認**
   - ダッシュボードから「リンクマネージャー」を選択
   - または、A8.netから提供されたConfig IDを確認
   - Config IDの例: `VksUx4HXzlqhWvj9t2cX`

3. **環境変数に設定**
   - **Key**: `NEXT_PUBLIC_A8_CONFIG_ID`
   - **Value**: A8.netから提供されたConfig ID

**注意**: リンクマネージャーを使用すると、ページ内の通常のリンクが自動的にA8.netのアフィリエイトリンクに変換されます。

## ステップ2: A8.netでメディアIDを確認（手動リンク変換用）

1. **A8.netにログイン**
   - https://www.a8.net/ にアクセス
   - アカウントでログイン

2. **メディアIDを確認**
   - ダッシュボードから「メディアID」を確認
   - 形式: `a` + 11桁の数字（例: `a12345678901`）
   - または、マイページの「メディア情報」から確認できます

## ステップ2: Netlifyで環境変数を設定

### ステップ2-1: Netlifyダッシュボードにログイン

1. https://app.netlify.com にアクセス
2. プロジェクト `meek-manatee-a78963` を選択

### ステップ2-2: 環境変数を追加

1. **「Site settings」→「Environment variables」を開く**

2. **環境変数を追加**
   - **Key**: `NEXT_PUBLIC_A8_AFFILIATE_ID`（または `NEXT_PUBLIC_A8_MEDIA_ID`）
   - **Value**: A8.netの**メディアID**（例: `a12345678901`）
   - **注意**: メディアIDは「a」で始まる11桁の数字です
   - **Scopes**: すべてにチェック（Production, Deploy previews, Branch deploys）
   - 「Save」をクリック

### ステップ2-3: 再デプロイ

1. **「Deploys」タブに戻る**
2. **「Trigger deploy」をクリック**
3. **「Clear cache and deploy site」を選択**
4. 再デプロイが開始されます（2-3分）

## ステップ3: 使用方法

### 方法A: 自動変換（推奨）

通常のURLを指定すると、自動的にA8.netのアフィリエイトリンクに変換されます：

```tsx
<AffiliateLink
  href="https://example.com/product"
  affiliateType="a8"
>
  商品を見る
</AffiliateLink>
```

### 方法B: 既存のA8.netリンクを使用

A8.netのリンク生成ツールで生成したリンクを直接使用することもできます：

```tsx
<AffiliateLink
  href="https://px.a8.net/svt/ejp/?aam2=xxxxx&url=..."
>
  商品を見る
</AffiliateLink>
```

## ステップ4: 動作確認

デプロイ完了後：

1. **サイトにアクセス**
   - https://kyushoku.site にアクセス
   - 日付ページ（例: `/2025-01-15`）を開く

2. **アフィリエイトリンクを確認**
   - 「🛒 給食関連商品」セクションを確認
   - リンクを右クリック → 「リンクのアドレスをコピー」
   - URLが `https://px.a8.net/svt/ejp/?aam2=...` の形式になっていることを確認

## 現在の実装状況

### 対応しているアフィリエイト

1. **Amazonアソシエイト**
   - 環境変数: `NEXT_PUBLIC_AMAZON_ASSOCIATE_ID`
   - 自動的に `tag` パラメータが追加されます

2. **A8.net**
   - 環境変数: `NEXT_PUBLIC_A8_AFFILIATE_ID`（メディアIDを設定）
   - 自動的にA8.netのリンク形式に変換されます
   - リンク形式: `https://px.a8.net/svt/ejp/?aam2=メディアID&url=...`

### リンクの優先順位

1. 既にA8.netのリンク形式の場合はそのまま使用
2. Amazonのリンクの場合はAmazonアソシエイトIDを追加
3. その他のリンクで `affiliateType="a8"` が指定されている場合はA8.netのリンクに変換

## 給食関連商品へのリンク例

### A8.netの商品リンクを追加する場合

```tsx
<AffiliateLink
  href="https://example.com/lunchbox"
  affiliateType="a8"
  className="inline-block px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-semibold no-underline"
>
  🍱 ランチボックスを見る
</AffiliateLink>
```

### 複数のアフィリエイトリンクを並べる場合

```tsx
<div className="flex flex-wrap gap-2">
  <AffiliateLink
    href="https://amzn.to/44d5r5t"
    title="Amazonで給食関連商品"
    className="inline-block px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-semibold no-underline"
  >
    🛒 Amazonで見る
  </AffiliateLink>
  <AffiliateLink
    href="https://example.com/lunchbox"
    affiliateType="a8"
    title="A8.netで給食関連商品"
    className="inline-block px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-semibold no-underline"
  >
    🍱 A8.netで見る
  </AffiliateLink>
</div>
```

## 収益の確認

1. **A8.netダッシュボードにログイン**
2. **「レポート」→「クリックレポート」を確認**
3. クリック数、成約数、報酬額が表示されます

## 注意事項

- **審査が必要**: A8.netの審査を通過する必要があります
- **利用規約を遵守**: A8.netの利用規約に従ってください
- **プライバシーポリシー**: アフィリエイトリンクを使用する場合、プライバシーポリシーに記載する必要があります
- **リンクの明示**: `rel="sponsored"` 属性が既に設定されています
- **リンクの自然な配置**: ユーザー体験を損なわないように、適切な場所に配置してください

## トラブルシューティング

### メディアIDが反映されない

1. **環境変数が正しく設定されているか確認**
   - `NEXT_PUBLIC_A8_AFFILIATE_ID` が設定されているか
   - 値が正しいか（メディアIDは「a」で始まる11桁の数字、例: `a12345678901`）
   - **重要**: メディアIDには「a」を含めて設定してください

2. **再デプロイを実行**
   - 環境変数を設定した後、必ず再デプロイが必要です

3. **ブラウザのキャッシュをクリア**
   - ブラウザのキャッシュをクリアして再読み込み

4. **コンソールでエラーを確認**
   - ブラウザの開発者ツールでエラーを確認

### リンクが正しく変換されない

- `affiliateType="a8"` を明示的に指定してください
- 環境変数 `NEXT_PUBLIC_A8_AFFILIATE_ID` が設定されているか確認してください

## 参考リンク

- [A8.net公式サイト](https://www.a8.net/)
- [A8.netヘルプセンター](https://www.a8.net/help/)
- [A8.net利用規約](https://www.a8.net/help/terms/)

## 次のステップ

A8.netのアフィリエイトリンクを追加したら、以下のような商品へのリンクを追加できます：

- ランチボックス
- 水筒
- 給食袋
- 箸箱
- 給食マット
- その他給食関連商品

商品リンクは、A8.netのリンク生成ツールで生成するか、通常のURLを `affiliateType="a8"` で指定することで自動変換されます。

